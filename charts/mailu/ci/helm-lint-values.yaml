hostnames:
  - mailu.cluster.local

domain: mailu.cluster.local

initialAccount:
  enabled: true
  username: mailadmin
  domain: mailu.cluster.local
  password: chang3m3!

secretKey: chang3m3!

subnet: 192.168.0.0/16

networkPolicy:
  enabled: true

persistence:
  single_pvc: false

postgresql:
  enabled: true
  postgresqlUsername: mailu
  postgresqlPassword: chang3m3!
  postgresqlDatabase: mailu
  primary:
    persistence:
      enabled: true
      size: 10Gi
    resources:
      requests:
        memory: 500Mi
        cpu: 100m
      limits:
        memory: 1Gi
        cpu: 2

ingress:
  enabled: true
  selfSigned: true
  annotations:
    auth.cluster.arpa/enabled: "false"

front:
  logLevel: INFO
  # image:
  #   tag: master
  resources:
    requests:
      memory: 100Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 2

admin:
  logLevel: DEBUG
  # image:
  #   tag: master
  resources:
    requests:
      memory: 500Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 2
  initContainers:
    # Add an initcontainer to wait for redis to be deployed
    - name: wait-for-redis
      image: busybox:1.34
      command:
        [
          "sh",
          "-c",
          'until nc -z -v -w30 {{ template "mailu.redis.serviceFqdn" . }} {{ template "mailu.redis.port" . }}; do echo "Waiting for redis..."; sleep 5; done;',
        ]
      resources:
        requests:
          memory: 50Mi
          cpu: 10m
        limits:
          memory: 1Gi
          cpu: 2

postfix:
  logLevel: INFO
  # image:
  #   tag: master
  resources:
    requests:
      memory: 2Gi
      cpu: 100m
    limits:
      memory: 2Gi
      cpu: 2

dovecot:
  logLevel: INFO
  # image:
  #   tag: master
  resources:
    requests:
      memory: 500Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 2

rspamd:
  logLevel: INFO
  # image:
  #   tag: master
  resources:
    requests:
      memory: 100Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 2
  serviceMonitor:
    enabled: true
    interval: 30s
    # Random relabellings to test behavior
    metricRelabelings:
      - action: keep
        regex: "kube_(daemonset|deployment|pod|namespace|node|statefulset).+"
        sourceLabels: [__name__]
    relabelings:
      - sourceLabels: [__meta_kubernetes_pod_node_name]
        separator: ;
        regex: ^(.*)$
        targetLabel: nodename
        replacement: $1
        action: replace

clamav:
  logLevel: INFO
  # image:
  #   tag: master
  resources:
    requests:
      memory: 1Gi
      cpu: 100m
    limits:
      memory: 2Gi
      cpu: 2

webmail:
  logLevel: INFO
  # image:
  #   tag: master
  resources:
    requests:
      memory: 100Mi
      cpu: 100m
    limits:
      memory: 1Gi
      cpu: 2

webdav:
  logLevel: INFO
  image:
    tag: master

fetchmail:
  logLevel: INFO
  # image:
  #   tag: master

redis:
  master:
    resources:
      requests:
        memory: 500Mi
        cpu: 100m
      limits:
        memory: 1Gi
        cpu: 2

tika:
  enabled: true
  languages:
    - en
    - fr

oletools:
  enabled: true

api:
  enabled: true
  token: chang3m3!
